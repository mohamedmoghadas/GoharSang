
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_layout.cshtml";
}

<div class="container dailyCol">
    <div class="row dailyRow">
        <div class="col dailyLDiv">
            <a class="btn btn-primary d-block dailyBtnTop" href="index.html" role="button">صفحه اصلی</a>
            <br>
            <label class="buyerLable">مشخصات خریدار</label>
            <div class="entryForm">
                <div class="row margTop1">
                    <div class="col-sm-2 col-4 rgEnLable">
                        <label>خریدار</label>
                    </div>
                    <div class="col-sm-4 col-8">
                        <input type="text" class="form-control float-right" id="CustomerName">
                    </div>
                    <div class="col-sm-2 col-4 rgEnLable">
                        <label>تاریخ بارگیری</label>

                    </div>
                    <div class="col-sm-4 col-8">
                        <input type="text" class="form-control jalali-datepicker" id="dateLoad">
                    </div>
                </div>
                <div class="row margTop1">
                    <div class="col-sm-2 col-4 rgEnLable">
                        <label>انبار</label>
                    </div>
                    <div class="col-sm-4 col-8">
                        <select id="SelectStore" class="form-control float-right width100" style="padding:2px 8px"></select>
                    </div>
                </div>
                <div class="row margTop1">
                    <div class="col-sm-2 col-4 rgEnLable">
                        <label>کد محصول</label>
                    </div>
                    <div class="col-sm-4 col-8">
                        <input type="text" class="form-control float-right txtLeft width50" id="productCode">
                        @*<a class="btn btn-primary  float-right" href="portableStone.html">=</a>
                            <button class="btn btn-info float-right" name="length">افزودن</button>*@
                    </div>
                </div>
                <div class="row margTop2">
                    <div class="col">
                        <ul class="list-group rgExUl">
                            <li class="list-group-item rgExitLi">
                                <lable>کوپ سنگ مرمریت 1000*1000 معدن لاشتر امینی</lable>
                                <button class="btn btn-danger float-left fa fa-trash"></button>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="row margTop1">
                    <div class="col">
                        <button class="btn btn-primary float-left SaveBtn" onclick="BtnExitOrder()">ذخیره</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


@section localscript{



    <script>
        window.onload = load();

        function load() {
           
            getStore();
        }
        

        function getStore() {
            $.ajax({
                url: '/RecordEntry/getStore',
                data: null,
                type: 'post',
                beforeSend: function () {
                    $(LoadingGift).show();
                },
                success: function (data) {

                    $(LoadingGift).hide();


                    var str = "<option value='0'>لطفا موردی را انتخاب نمایید</option>";


                    for (var i in data) {

                        str += "<option value=" + data[i].Id + ">" + data[i].Display + "</option>";
                    }
                    SelectStore.innerHTML = str;


                }
            });

        }


    </script>


    <script>
        function Exitorder(Id, CustomerFullName, IdStore, ProductCode) {
            this.Id = Id;
            this.CustomerFullName = CustomerFullName;
            this.IdStore = IdStore;
            this.ProductCode = ProductCode;
        }
        var _Exitorde = new Exitorder(0, "", 0, "");
    </script>


    <script>
        function BtnExitOrder() {


            if (CustomerName.value == "" || SelectStore.value == 0 || productCode.value=="") {
                AlertInAjax("تمامی اطلاعات را وارد نمایید", modalAlertInAjax, "alert-danger");
                $(modalAlertInAjax).modal("show");

                return;
            }

            else {
                _Exitorde.CustomerFullName = CustomerName.value;
                _Exitorde.IdStore = SelectStore.value;
                _Exitorde.ProductCode = productCode.value;


                var DateLoad = dateLoad.value;

                $.ajax({
                    url: '/ExitOrder/ExitOrder',
                    data: { _Exitorde: _Exitorde, DateLoad: DateLoad },
                    type: 'post',
                    beforeSend: function () {
                        $(LoadingGift).show();
                    },

                    success: function (data) {

                        $(LoadingGift).hide();


                        AlertInAjax("عملیات با موفقیت انجام شد", modalerrorInAjax, "alert-success");
                        $(modalAlertInAjax).modal("show");

                        $(modalAlertInAjax).on("hidden.bs.modal", function () {

                            location.href = "/ExitOrder/Index";
                        });
                    }
                });
            }

            
        }
    </script>

}